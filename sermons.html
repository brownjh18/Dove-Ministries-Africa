<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sermons - Dove Ministries Africa</title>
    <meta name="description" content="Listen to inspiring sermons and teachings from Dove Ministries Africa. Access audio sermons, video messages, and biblical teachings.">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="assets/css/floating-devotion.css">
    <style>
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
    <link rel="icon" href="assets/images/logo.png" type="image/png">
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg fixed w-full z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <img src="assets/images/logo.png" alt="DMA Logo" class="h-10 w-auto">
                </div>
                <div class="hidden md:flex items-center space-x-8">
                    <a href="index.html" class="text-gray-700 hover:text-blue-600 transition-colors">Home</a>
                    <a href="about.html" class="text-gray-700 hover:text-blue-600 transition-colors">About</a>
                    <div class="relative group"><a href="ministries.html" class="text-gray-700 hover:text-blue-600 transition-colors flex items-center">Ministries<svg class="ml-1 w-4 h-4 transition-transform group-hover:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg></a><div class="absolute left-0 mt-2 w-64 bg-white rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-50 border border-gray-200"><div class="py-2"><a href="marriedcouples.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors">Married Couples Ministry</a><a href="youth.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors">Youth Ministry</a><a href="children.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors">Children Ministry</a><a href="evangelism.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors">Evangelism Ministry</a><a href="intercessions.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors">Intercessions Ministry</a><a href="worship.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition-colors">Worship Ministry</a><div class="border-t border-gray-100 my-2"></div><a href="ministries.html" class="block px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 font-medium transition-colors">View All Ministries</a></div></div></div>
                    <a href="events.html" class="text-gray-700 hover:text-blue-600 transition-colors">Events</a>
                    <a href="sermons.html" class="text-blue-600 hover:text-blue-800 transition-colors">Sermons</a>
                    <a href="gallery.html" class="text-gray-700 hover:text-blue-600 transition-colors">Gallery</a>
                    <a href="contact.html" class="text-gray-700 hover:text-blue-600 transition-colors">Contact</a>
                    <a href="donate.html" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">Donate</a>
                </div>
                <div class="md:hidden flex items-center">
                    <button id="mobile-menu-button" class="text-gray-700 hover:text-blue-600">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile menu overlay -->
        <div id="mobile-menu-overlay"></div>

        <!-- Mobile menu -->
        <div id="mobile-menu">
            <div class="px-2">
                <a href="index.html" class="block px-3 py-2 text-gray-700 hover:text-blue-600">Home</a>
                <a href="about.html" class="block px-3 py-2 text-gray-700 hover:text-blue-600">About</a>
                <div class="ministries-menu">
                    <a href="#" class="ministries-toggle block px-3 py-2 text-gray-700 hover:text-blue-600 flex items-center justify-between">
                        <span>Ministries</span>
                        <i class="fas fa-chevron-down text-xs transition-transform duration-200"></i>
                    </a>
                    <div class="ministries-submenu hidden pl-4">
                        <a href="marriedcouples.html" class="block px-2 py-1 text-sm text-gray-600 hover:text-blue-600">Married Couples</a>
                        <a href="youth.html" class="block px-2 py-1 text-sm text-gray-600 hover:text-blue-600">Youth</a>
                        <a href="children.html" class="block px-2 py-1 text-sm text-gray-600 hover:text-blue-600">Children</a>
                        <a href="evangelism.html" class="block px-2 py-1 text-sm text-gray-600 hover:text-blue-600">Evangelism</a>
                        <a href="intercessions.html" class="block px-2 py-1 text-sm text-gray-600 hover:text-blue-600">Intercessions</a>
                        <a href="worship.html" class="block px-2 py-1 text-sm text-gray-600 hover:text-blue-600">Worship</a>
                        <div class="border-t border-gray-200 my-1"></div>
                        <a href="ministries.html" class="block px-2 py-1 text-sm text-blue-600 font-medium">View All</a>
                    </div>
                </div>
                <a href="events.html" class="block px-3 py-2 text-gray-700 hover:text-blue-600">Events</a>
                <a href="sermons.html" class="block px-3 py-2 bg-blue-50 text-blue-600">Sermons</a>
                <a href="gallery.html" class="block px-3 py-2 text-gray-700 hover:text-blue-600">Gallery</a>
                <a href="contact.html" class="block px-3 py-2 text-gray-700 hover:text-blue-600">Contact</a>
                <a href="donate.html" class="block px-3 py-2 bg-blue-600 text-white rounded-lg text-center">Donate</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="pt-16 relative min-h-screen bg-gradient-to-br from-blue-900 via-purple-800 to-blue-900 flex items-center overflow-hidden">
        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
        <div class="absolute inset-0 bg-cover bg-center" style="background-image: url('assets/images/hero-sermons.jpg');"></div>

        <!-- Animated background elements -->
        <div class="absolute inset-0">
            <div class="absolute top-20 left-10 w-32 h-32 bg-white/10 rounded-full animate-pulse"></div>
            <div class="absolute top-40 right-20 w-24 h-24 bg-blue-300/20 rounded-full animate-bounce" style="animation-delay: 1s;"></div>
            <div class="absolute bottom-32 left-1/4 w-40 h-40 bg-purple-300/20 rounded-full animate-pulse" style="animation-delay: 2s;"></div>
        </div>

        <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20 w-full">
            <div class="text-center text-white">
                <div class="inline-flex items-center bg-white/20 backdrop-blur-sm rounded-full px-6 py-2 mb-8">
                    <i class="fas fa-church mr-2 text-yellow-300"></i>
                    <span class="text-sm font-medium uppercase tracking-wide">Dove Ministries Africa</span>
                </div>

                <h1 class="text-5xl md:text-7xl font-bold mb-6 drop-shadow-2xl leading-tight">
                    Sermons &<br>
                    <span class="text-yellow-300">Teachings</span>
                </h1>

                <p class="text-xl md:text-2xl text-gray-100 drop-shadow-lg max-w-4xl mx-auto mb-12 leading-relaxed">
                    Be inspired by powerful messages of faith, hope, and transformation from our pastors and teachers across Africa.
                </p>

                <div class="flex flex-col sm:flex-row gap-6 justify-center items-center">
                    <a href="#live-service" class="bg-red-600 text-white px-10 py-4 rounded-xl hover:bg-red-700 transition-all duration-300 transform hover:scale-105 shadow-2xl text-lg font-bold flex items-center">
                        <i class="fas fa-play-circle mr-3 text-2xl"></i>
                        Watch Live Service
                    </a>
                    <a href="#sermons-grid" class="border-2 border-white text-white px-10 py-4 rounded-xl hover:bg-white hover:text-blue-900 transition-all duration-300 transform hover:scale-105 text-lg font-bold flex items-center">
                        <i class="fas fa-list mr-3"></i>
                        Browse Sermons
                    </a>
                </div>

                <!-- Scroll indicator -->
                <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 animate-bounce">
                    <i class="fas fa-chevron-down text-white/60 text-2xl"></i>
                </div>
            </div>
        </div>
    </section>

    <!-- Live Service Section - Prominent Hero Style -->
    <section id="live-service" class="py-16 bg-gradient-to-br from-black-300 via-red-600 to-black relative overflow-hidden">
        <div class="absolute inset-0 bg-black bg-opacity-20"></div>
        <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <!-- Loading state -->
            <div id="live-loading" class="text-center py-20">
                <div class="animate-spin rounded-full h-20 w-20 border-b-4 border-white mx-auto mb-8"></div>
                <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">Checking for Live Service</h2>
                <p class="text-xl text-red-100">Please wait while we check for active live streams...</p>
            </div>

            <!-- Live stream - Enhanced prominent layout -->
            <div id="live-stream" class="hidden">
                <div class="text-center mb-8">
                    <div class="inline-flex items-center bg-white/20 backdrop-blur-sm rounded-full px-6 py-3 mb-4">
                        <div class="w-4 h-4 bg-red-500 rounded-full mr-3 animate-pulse"></div>
                        <span class="text-white font-bold text-lg uppercase tracking-wide">LIVE NOW</span>
                    </div>
                    <h1 id="live-title" class="text-4xl md:text-5xl font-bold text-white mb-4 leading-tight">Loading live service details...</h1>
                    <div class="flex items-center justify-center space-x-8 text-white/90 mb-8">
                        <span id="live-viewers" class="flex items-center text-lg">
                            <i class="fas fa-eye mr-2"></i>
                            <span>Loading viewers...</span>
                        </span>
                        <span id="live-date" class="flex items-center text-lg">
                            <i class="fas fa-calendar mr-2"></i>
                            <span>Loading date...</span>
                        </span>
                    </div>
                </div>

                <!-- Video Player Section - Larger and more prominent -->
                <div class="bg-black rounded-2xl shadow-2xl overflow-hidden mb-8 max-w-6xl mx-auto">
                    <div class="relative bg-black" style="padding-bottom: 56.25%; height: 0;">
                        <iframe id="live-iframe" class="absolute top-0 left-0 w-full h-full rounded-2xl" src="" frameborder="0" allowfullscreen></iframe>
                    </div>
                </div>

                <!-- Action buttons and details -->
                <div class="text-center">
                    <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-8">
                        <button onclick="openLiveInYouTube()" class="bg-white text-red-600 px-8 py-4 rounded-xl hover:bg-gray-100 transition-all duration-300 transform hover:scale-105 shadow-lg font-bold text-lg flex items-center">
                            <i class="fab fa-youtube mr-3 text-2xl"></i>
                            Watch on YouTube
                        </button>
                        <button class="bg-red-500 text-white px-8 py-4 rounded-xl hover:bg-red-400 transition-all duration-300 transform hover:scale-105 shadow-lg font-bold text-lg flex items-center">
                            <i class="fas fa-share mr-3"></i>
                            Share Service
                        </button>
                    </div>

                    <!-- Description and details -->
                    <div class="bg-black/30 backdrop-blur-sm rounded-2xl p-8 max-w-4xl mx-auto">
                        <h3 class="text-2xl font-bold text-white mb-4">About this Live Service</h3>
                        <p id="live-description" class="text-white/90 text-lg leading-relaxed mb-6">Loading description...</p>
                        <div class="grid md:grid-cols-3 gap-6">
                            <div class="flex items-center text-white/90">
                                <i class="fas fa-user mr-3 text-2xl text-yellow-300"></i>
                                <div>
                                    <p class="text-sm uppercase tracking-wide text-white/70">Speaker</p>
                                    <p id="live-speaker" class="font-semibold text-lg text-white">Loading...</p>
                                </div>
                            </div>
                            <div class="flex items-center text-white/90">
                                <i class="fas fa-clock mr-3 text-2xl text-blue-300"></i>
                                <div>
                                    <p class="text-sm uppercase tracking-wide text-white/70">Status</p>
                                    <p id="live-duration" class="font-semibold text-lg text-white">Live Stream</p>
                                </div>
                            </div>
                            <div class="flex items-center text-white/90">
                                <i class="fas fa-calendar mr-3 text-2xl text-green-300"></i>
                                <div>
                                    <p class="text-sm uppercase tracking-wide text-white/70">Started</p>
                                    <p id="live-start-time" class="font-semibold text-lg text-white">Loading...</p>
                                </div>
                            </div>
                        </div>
                        <div class="mt-6 pt-6 border-t border-white/20">
                            <div class="grid md:grid-cols-2 gap-6">
                                <div class="flex items-center text-white/90">
                                    <i class="fas fa-eye mr-3 text-2xl text-purple-300"></i>
                                    <div>
                                        <p class="text-sm uppercase tracking-wide text-white/70">Live Viewers</p>
                                        <p id="live-viewers-count" class="font-semibold text-lg text-white">Loading...</p>
                                    </div>
                                </div>
                                <div class="flex items-center text-white/90">
                                    <i class="fas fa-church mr-3 text-2xl text-red-300"></i>
                                    <div>
                                        <p class="text-sm uppercase tracking-wide text-white/70">Ministry</p>
                                        <p class="font-semibold text-lg text-white">Dove Ministries Africa</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Last service details - Enhanced design -->
            <div id="last-service" class="hidden">
                <div class="text-center">
                    <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-12 max-w-2xl mx-auto">
                        <i class="fas fa-clock text-8xl text-white/60 mb-6"></i>
                        <h3 class="text-3xl font-bold text-white mb-4">Service Has Ended</h3>
                        <p class="text-white/80 text-lg mb-8">Our last live service has concluded. Watch the recording below.</p>
                        <div id="last-service-details" class="mb-8 text-left">
                            <!-- Details will be populated by JavaScript -->
                        </div>
                        <button onclick="watchLastService()" class="bg-white text-red-600 px-10 py-4 rounded-xl hover:bg-gray-100 transition-all duration-300 transform hover:scale-105 shadow-lg font-bold text-lg inline-flex items-center">
                            <i class="fas fa-play mr-3"></i>
                            Watch Last Service
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sermon Filters - Updated for dynamic content -->
    <section class="py-12 bg-white border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-8">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-2">Explore Our Sermons</h2>
                <p class="text-gray-600">Filter by content type or browse all recent messages</p>
            </div>
            <div class="flex flex-wrap justify-center gap-4">
                <button class="filter-btn active bg-blue-600 text-white px-8 py-3 rounded-full hover:bg-blue-700 transition-all duration-300 transform hover:scale-105 shadow-lg font-medium" data-filter="all">
                    <i class="fas fa-th-large mr-2"></i>All Sermons
                </button>
                <button class="filter-btn bg-gray-200 text-gray-700 px-8 py-3 rounded-full hover:bg-blue-100 hover:text-blue-700 transition-all duration-300 transform hover:scale-105 font-medium" data-filter="recent">
                    <i class="fas fa-clock mr-2"></i>Most Recent
                </button>
                <button class="filter-btn bg-gray-200 text-gray-700 px-8 py-3 rounded-full hover:bg-green-100 hover:text-green-700 transition-all duration-300 transform hover:scale-105 font-medium" data-filter="popular">
                    <i class="fas fa-fire mr-2"></i>Most Viewed
                </button>
                <button class="filter-btn bg-gray-200 text-gray-700 px-8 py-3 rounded-full hover:bg-purple-100 hover:text-purple-700 transition-all duration-300 transform hover:scale-105 font-medium" data-filter="series">
                    <i class="fas fa-list mr-2"></i>Sermon Series
                </button>
            </div>
        </div>
    </section>

    <!-- Recent Sermons Gallery -->
    <section id="sermons-gallery" class="py-16 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">Recent Sermons Gallery</h2>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                    Watch our latest teachings and messages from Dove Ministries Africa - most recent first
                </p>
            </div>

            <!-- Loading state for sermons -->
            <div id="sermons-loading" class="text-center py-20">
                <div class="animate-spin rounded-full h-16 w-16 border-b-4 border-blue-600 mx-auto mb-6"></div>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">Loading Sermons</h3>
                <p class="text-gray-600">Fetching the latest videos from our YouTube channel...</p>
            </div>

            <!-- Error state for sermons -->
            <div id="sermons-error" class="hidden text-center py-20">
                <i class="fas fa-exclamation-triangle text-6xl text-red-400 mb-6"></i>
                <h3 class="text-2xl font-bold text-gray-900 mb-2">Unable to Load Sermons</h3>
                <p class="text-gray-600 mb-6">We're having trouble loading the latest sermons. Please try again later.</p>
                <button onclick="loadRecentSermons()" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition-colors">
                    Try Again
                </button>
            </div>

            <!-- Video Player Modal -->
            <div id="video-modal" class="fixed inset-0 bg-black bg-opacity-75 z-50 hidden flex items-center justify-center p-4">
                <div class="bg-white rounded-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden relative">
                    <button onclick="closeVideoModal()" class="absolute top-4 right-4 bg-black bg-opacity-50 text-white w-10 h-10 rounded-full flex items-center justify-center hover:bg-opacity-75 transition-all z-10">
                        <i class="fas fa-times"></i>
                    </button>
                    <div class="relative bg-black" style="padding-bottom: 56.25%; height: 0;">
                        <iframe id="modal-iframe" class="absolute top-0 left-0 w-full h-full rounded-t-2xl" src="" frameborder="0" allowfullscreen></iframe>
                    </div>
                    <div class="p-6">
                        <h3 id="modal-title" class="text-2xl font-bold text-gray-900 mb-3">Video Title</h3>
                        <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                            <span id="modal-date" class="flex items-center">
                                <i class="fas fa-calendar mr-1"></i>Date
                            </span>
                            <span id="modal-views" class="flex items-center">
                                <i class="fas fa-eye mr-1"></i>Views
                            </span>
                            <span id="modal-duration" class="flex items-center">
                                <i class="fas fa-clock mr-1"></i>Duration
                            </span>
                        </div>
                        <p id="modal-description" class="text-gray-600 leading-relaxed">Video description...</p>
                        <div class="mt-4 pt-4 border-t border-gray-200">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-500">Dove Ministries Africa</span>
                                <button onclick="window.open('https://www.youtube.com/watch?v=' + document.getElementById('modal-iframe').src.split('/embed/')[1].split('?')[0], '_blank')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors text-sm">
                                    <i class="fab fa-youtube mr-1"></i> Watch on YouTube
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sermons Gallery Grid -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="sermons-grid">
                <!-- Sermon cards will be dynamically populated -->
            </div>

            <!-- Load More Button -->
            <div class="text-center mt-12" id="load-more-container">
                <button id="load-more-btn" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed">
                    <span class="loading-text">Load More Sermons</span>
                    <span class="loading-spinner hidden">
                        <i class="fas fa-spinner fa-spin mr-2"></i>
                        Loading...
                    </span>
                </button>
            </div>
        </div>
    </section>

    <!-- Sermon Series -->
    <section class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">Current Sermon Series</h2>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                    Follow along with our current teaching series for deeper spiritual growth.
                </p>
            </div>
            <div class="grid md:grid-cols-2 gap-8">
                <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-8">
                    <div class="flex items-center mb-6">
                        <div class="w-12 h-12 bg-purple-600 rounded-full flex items-center justify-center mr-4">
                            <i class="fas fa-apple-alt text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold text-gray-900">Fruit of the Spirit</h3>
                            <p class="text-purple-600">9-part series</p>
                        </div>
                    </div>
                    <p class="text-gray-600 mb-6">
                        Explore the nine fruits of the Spirit mentioned in Galatians 5:22-23 and learn how to cultivate them in your daily life.
                    </p>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-700">Part 1: Love</span>
                            <span class="text-gray-500">Completed</span>
                        </div>
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-700">Part 2: Joy</span>
                            <span class="text-gray-500">Completed</span>
                        </div>
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-700">Part 3: Peace</span>
                            <span class="text-purple-600 font-medium">Current</span>
                        </div>
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-700">Parts 4-9</span>
                            <span class="text-gray-500">Upcoming</span>
                        </div>
                    </div>
                </div>
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-8">
                    <div class="flex items-center mb-6">
                        <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center mr-4">
                            <i class="fas fa-praying-hands text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold text-gray-900">Prayer & Intercession</h3>
                            <p class="text-blue-600">6-part series</p>
                        </div>
                    </div>
                    <p class="text-gray-600 mb-6">
                        Learn the power of prayer and develop a deeper relationship with God through focused intercession.
                    </p>
                    <div class="space-y-3">
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-700">The Heart of Prayer</span>
                            <span class="text-gray-500">Completed</span>
                        </div>
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-700">Praying with Faith</span>
                            <span class="text-gray-500">Completed</span>
                        </div>
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-700">Interceding for Others</span>
                            <span class="text-blue-600 font-medium">Current</span>
                        </div>
                        <div class="flex items-center justify-between text-sm">
                            <span class="text-gray-700">Parts 4-6</span>
                            <span class="text-gray-500">Upcoming</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 lg:gap-12">
                <div class="space-y-6">
                    <h3 class="text-lg font-semibold mb-4">ABOUT US</h3>
                    <p class="text-gray-400">
                        The Dove Ministries Africa was founded in 2005 by Pastor Daniel and Erica Kaggwa, under the tutelage of Apostle Harry and Deborah Stackhouse. It is located in Nfuufu Zone, Zzana-Bunamwaya in Makindye-Ssabagabo municipality, about 500 metres from the Zzana Roundabout on Entebbe Road.
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-facebook-f text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-twitter text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-instagram text-xl"></i>
                        </a>
                        <a href="#" class="text-gray-400 hover:text-white transition-colors">
                            <i class="fab fa-youtube text-xl"></i>
                        </a>
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-6">MINISTERIES</h3>
                    <div class="space-y-3">
                        <a href="marriedcouples.html" class="block text-gray-400 hover:text-white transition-colors">Married Couples</a>
                        <a href="youth.html" class="block text-gray-400 hover:text-white transition-colors">Youth</a>
                        <a href="children.html" class="block text-gray-400 hover:text-white transition-colors">Children</a>
                        <a href="evangelism.html" class="block text-gray-400 hover:text-white transition-colors">Evangelism</a>
                        <a href="intercessions.html" class="block text-gray-400 hover:text-white transition-colors">Intercessions</a>
                        <a href="worship.html" class="block text-gray-400 hover:text-white transition-colors">Worship</a>
                    </div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold mb-6">REACH US</h3>
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <i class="fas fa-map-marker-alt text-blue-400 mt-1 mr-3"></i>
                            <div>
                                <p>Nfuufu Zone, Zzana-Bunamwaya</p>
                                <p>P.O.Box 7044, Kampla uganda,</p>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-phone text-blue-400 mr-3"></i>
                            <span>+256 772824677</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-phone text-blue-400 mr-3"></i>
                            <span>+256 700116734</span>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-envelope text-blue-400 mr-3"></i>
                            <span>thesignofthedoveministries@gmail.com</span>
                        </div>
                    </div>
                </div>

                <div>
                    <h3 class="text-lg font-semibold mb-6">Service Hours</h3>
                    <div class="space-y-3">
                        <div>
                            <p class="font-medium">Sunday Services</p>
                            <p class="text-gray-400 text-sm">7:30 AM - First Service</p>
                            <p class="text-gray-400 text-sm">10:30 AM - Second Service</p>
                        </div>
                        <div>
                            <p class="font-medium">Office Hours</p>
                            <p class="text-gray-400 text-sm">Monday - Friday: 9:00 AM - 5:00 PM</p>
                            <p class="text-gray-400 text-sm">Saturday: 10:00 AM - 2:00 PM</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-12 pt-8">
                <div class="text-center">
                    <p class="text-gray-400 text-sm">Â© 2025 Dove Ministeries Africa. All Rights Reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="assets/js/main.js"></script><script src="assets/js/devotion-widget.js"></script>
    <script>
        // YouTube API configuration
        const API_KEY = "AIzaSyAj8q7g9KxiDOFw4FAL701SCP2e4KJs3us";
        const CHANNEL_ID = "UCeD__nWtSfoyMRZAL0KYjhw";

        // Debug: Check if we're running from localhost
        console.log('Page loaded from:', window.location.origin);
        console.log('Is localhost:', window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1');

        // Featured sermon functionality
        async function loadFeaturedSermon() {
            try {
                const response = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${CHANNEL_ID}&order=date&type=video&maxResults=1&key=${API_KEY}`);
                const data = await response.json();

                if (data.items && data.items.length > 0) {
                    const video = data.items[0];
                    const videoId = video.id.videoId;

                    // Get video details for duration
                    const detailsResponse = await fetch(`https://www.googleapis.com/youtube/v3/videos?part=contentDetails&id=${videoId}&key=${API_KEY}`);
                    const detailsData = await detailsResponse.json();

                    const publishedAt = new Date(video.snippet.publishedAt);
                    const duration = detailsData.items && detailsData.items.length > 0 ?
                        parseDuration(detailsData.items[0].contentDetails.duration) : 'N/A';

                    // Update featured sermon content
                    document.getElementById('featured-title').textContent = video.snippet.title;
                    document.getElementById('featured-description').textContent = video.snippet.description.substring(0, 200) + '...';
                    document.getElementById('featured-speaker').textContent = video.snippet.channelTitle;
                    document.getElementById('featured-date').textContent = publishedAt.toLocaleDateString();
                    document.getElementById('featured-duration').textContent = duration;

                    // Set thumbnail
                    const thumbnailElement = document.getElementById('featured-thumbnail');
                    thumbnailElement.style.backgroundImage = `url(${video.snippet.thumbnails.high.url})`;
                    thumbnailElement.style.backgroundSize = 'cover';
                    thumbnailElement.style.backgroundPosition = 'center';

                    // Set up watch button
                    document.getElementById('featured-watch-btn').onclick = () => {
                        window.open(`https://www.youtube.com/watch?v=${videoId}`, '_blank');
                    };

                    // Set up share button
                    document.getElementById('featured-share-btn').onclick = () => {
                        shareSermon(videoId, video.snippet.title);
                    };

                    // Store video ID for play function
                    window.featuredVideoId = videoId;

                    // Show content
                    document.getElementById('featured-sermon-loading').classList.add('hidden');
                    document.getElementById('featured-sermon-content').classList.remove('hidden');
                }
            } catch (error) {
                console.error('Error loading featured sermon:', error);
                // Show error state for featured sermon
                document.getElementById('featured-sermon-loading').innerHTML = `
                    <div class="text-center">
                        <i class="fas fa-exclamation-triangle text-4xl text-red-300 mb-4"></i>
                        <p class="text-white/80">Unable to load featured sermon</p>
                        <button onclick="loadFeaturedSermon()" class="mt-4 bg-white/20 text-white px-6 py-2 rounded-lg hover:bg-white/30 transition-colors">
                            Try Again
                        </button>
                    </div>
                `;
                setTimeout(() => {
                    document.getElementById('featured-sermon-loading').classList.add('hidden');
                    document.getElementById('featured-sermon-content').classList.remove('hidden');
                }, 3000);
            }
        }

        function parseDuration(duration) {
            const match = duration.match(/PT(\d+H)?(\d+M)?(\d+S)?/);
            const hours = (parseInt(match[1]) || 0);
            const minutes = (parseInt(match[2]) || 0);
            const seconds = (parseInt(match[3]) || 0);

            if (hours > 0) {
                return `${hours}h ${minutes}m`;
            } else {
                return `${minutes}m ${seconds}s`;
            }
        }

        function playFeaturedSermon() {
            if (window.featuredVideoId) {
                window.open(`https://www.youtube.com/watch?v=${window.featuredVideoId}`, '_blank');
            }
        }

        // Test API connectivity first
        async function testAPIConnection() {
            try {
                console.log('Testing API connection...');
                console.log('API Key:', API_KEY.substring(0, 10) + '...');
                console.log('Channel ID:', CHANNEL_ID);

                // Test basic channel info
                const channelResponse = await fetch(`https://www.googleapis.com/youtube/v3/channels?part=snippet&id=${CHANNEL_ID}&key=${API_KEY}`);
                const channelData = await channelResponse.json();

                console.log('Channel API response:', channelData);

                if (channelData.error) {
                    console.error('API Error:', channelData.error);
                    return false;
                }

                return true;
            } catch (error) {
                console.error('API connection test failed:', error);
                return false;
            }
        }

        // Live service functionality
        async function checkLiveService() {
            try {
                console.log('Checking for live services...');

                // First test API connection
                const apiWorking = await testAPIConnection();
                if (!apiWorking) {
                    throw new Error('API connection failed');
                }

                // Check videos endpoint for live streaming details
                const videosResponse = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${CHANNEL_ID}&order=date&type=video&maxResults=10&key=${API_KEY}`);
                const videosData = await videosResponse.json();

                console.log('Recent videos response:', videosData);

                if (videosData.error) {
                    console.error('Search API Error:', videosData.error);
                    throw new Error('YouTube API error: ' + videosData.error.message);
                }

                const liveLoading = document.getElementById('live-loading');
                const liveStream = document.getElementById('live-stream');
                const lastService = document.getElementById('last-service');

                if (videosData.items && videosData.items.length > 0) {
                    console.log('Found', videosData.items.length, 'videos to check');

                    // Check each video for live status
                    for (const item of videosData.items) {
                        try {
                            console.log('Checking video:', item.id.videoId, item.snippet.title);
                            const videoDetailsResponse = await fetch(`https://www.googleapis.com/youtube/v3/videos?part=liveStreamingDetails&id=${item.id.videoId}&key=${API_KEY}`);
                            const videoDetails = await videoDetailsResponse.json();

                            console.log('Video details for', item.id.videoId, ':', videoDetails);

                            if (videoDetails.error) {
                                console.error('Video details API error:', videoDetails.error);
                                continue;
                            }

                            if (videoDetails.items && videoDetails.items.length > 0) {
                                const liveDetails = videoDetails.items[0].liveStreamingDetails;

                                if (liveDetails) {
                                    console.log('Live details found:', liveDetails);

                                    // Check if it's currently live
                                    if (liveDetails.actualStartTime && !liveDetails.actualEndTime) {
                                        console.log('Found active live stream:', item);
                                        // Set up iframe
                                        const liveIframe = document.getElementById('live-iframe');
                                        liveIframe.src = `https://www.youtube.com/embed/${item.id.videoId}?autoplay=0&rel=0`;

                                        // Load live video details
                                        await loadLiveVideoDetails(item);

                                        liveLoading.classList.add('hidden');
                                        liveStream.classList.remove('hidden');
                                        lastService.classList.add('hidden');
                                        return; // Exit function once we find a live stream
                                    }
                                    // Check if it's upcoming
                                    else if (liveDetails.scheduledStartTime && !liveDetails.actualStartTime) {
                                        const scheduledTime = new Date(liveDetails.scheduledStartTime);
                                        const now = new Date();

                                        console.log('Found scheduled stream:', scheduledTime, 'Current time:', now);

                                        if (scheduledTime > now) {
                                            console.log('Stream is upcoming');
                                            showUpcomingStream(item);
                                            liveLoading.classList.add('hidden');
                                            liveStream.classList.remove('hidden');
                                            lastService.classList.add('hidden');
                                            return; // Exit function once we find an upcoming stream
                                        }
                                    }
                                } else {
                                    console.log('No live details for video:', item.id.videoId);
                                }
                            } else {
                                console.log('No video details found for:', item.id.videoId);
                            }
                        } catch (videoError) {
                            console.error('Error checking video details for', item.id.videoId, ':', videoError);
                            continue; // Continue checking other videos
                        }
                    }
                } else {
                    console.log('No videos found for channel');
                }

                // If no live or upcoming streams found, show last service
                console.log('No live or upcoming streams found, showing last service');
                await loadLastServiceDetails();
                liveLoading.classList.add('hidden');
                liveStream.classList.add('hidden');
                lastService.classList.remove('hidden');

            } catch (error) {
                console.error('Error checking live service:', error);
                // Show error state for live service
                document.getElementById('live-loading').innerHTML = `
                    <div class="text-center">
                        <i class="fas fa-wifi-slash text-4xl text-red-300 mb-4"></i>
                        <h3 class="text-3xl font-bold text-white mb-2">Connection Error</h3>
                        <p class="text-white/80">Unable to check for live services</p>
                        <p class="text-white/60 text-sm mt-2">Error: ${error.message}</p>
                        <button onclick="checkLiveService()" class="mt-6 bg-white/20 text-white px-6 py-3 rounded-lg hover:bg-white/30 transition-colors">
                            Try Again
                        </button>
                    </div>
                `;
                setTimeout(async () => {
                    await loadLastServiceDetails();
                    document.getElementById('live-loading').classList.add('hidden');
                    document.getElementById('live-stream').classList.add('hidden');
                    document.getElementById('last-service').classList.remove('hidden');
                }, 3000);
            }
        }

        // Show upcoming stream UI
        function showUpcomingStream(upcomingVideo) {
            const liveLoading = document.getElementById('live-loading');
            const liveStream = document.getElementById('live-stream');
            const lastService = document.getElementById('last-service');

            // Update the live stream section to show upcoming
            document.getElementById('live-title').textContent = upcomingVideo.snippet.title;
            document.getElementById('live-description').textContent = upcomingVideo.snippet.description.substring(0, 150) + '...';

            // Change the live indicator to upcoming
            const liveIndicator = document.querySelector('.flex.items-center.mb-2');
            liveIndicator.innerHTML = `
                <div class="w-3 h-3 bg-yellow-500 rounded-full mr-2 animate-pulse"></div>
                <span class="text-yellow-600 font-semibold text-sm uppercase tracking-wide">UPCOMING</span>
            `;

            // Update buttons
            const watchButton = document.querySelector('button[onclick="openLiveInYouTube()"]');
            watchButton.innerHTML = '<i class="fab fa-youtube mr-2"></i>Set Reminder';
            watchButton.onclick = () => openUpcomingInYouTube(upcomingVideo.id.videoId);

            // Update stats
            document.getElementById('live-viewers').innerHTML = '<i class="fas fa-clock mr-1"></i><span>Scheduled</span>';
            document.getElementById('live-date').innerHTML = `<i class="fas fa-calendar mr-1"></i><span>${new Date(upcomingVideo.snippet.publishedAt).toLocaleDateString()}</span>`;

            // Set up iframe (will show upcoming stream)
            const liveIframe = document.getElementById('live-iframe');
            liveIframe.src = `https://www.youtube.com/embed/${upcomingVideo.id.videoId}?autoplay=0&rel=0`;

            // Store video ID
            window.liveVideoId = upcomingVideo.id.videoId;

            liveLoading.classList.add('hidden');
            liveStream.classList.remove('hidden');
            lastService.classList.add('hidden');
        }

        function openUpcomingInYouTube(videoId) {
            window.open(`https://www.youtube.com/watch?v=${videoId}`, '_blank');
        }

        async function loadLastServiceDetails() {
            try {
                // First try to get completed live streams
                const response = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${CHANNEL_ID}&eventType=completed&type=video&order=date&maxResults=5&key=${API_KEY}`);
                const data = await response.json();

                let lastLiveVideo = null;

                if (data.items && data.items.length > 0) {
                    // Use the most recent completed live stream
                    lastLiveVideo = data.items[0];
                } else {
                    // Fallback: get recent videos and check if any were live
                    const fallbackResponse = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${CHANNEL_ID}&order=date&type=video&maxResults=10&key=${API_KEY}`);
                    const fallbackData = await fallbackResponse.json();

                    if (fallbackData.items && fallbackData.items.length > 0) {
                        // Use the most recent video as fallback
                        lastLiveVideo = fallbackData.items[0];
                    }
                }

                if (lastLiveVideo) {
                    const videoId = lastLiveVideo.id.videoId;
                    const publishedAt = new Date(lastLiveVideo.snippet.publishedAt);

                    // Get video details for duration
                    const detailsResponse = await fetch(`https://www.googleapis.com/youtube/v3/videos?part=contentDetails&id=${videoId}&key=${API_KEY}`);
                    const detailsData = await detailsResponse.json();

                    const duration = detailsData.items && detailsData.items.length > 0 ?
                        parseDuration(detailsData.items[0].contentDetails.duration) : 'N/A';

                    const detailsContainer = document.getElementById('last-service-details');

                    detailsContainer.innerHTML = `
                        <div class="text-left">
                            <h4 class="text-xl font-semibold mb-2">${lastLiveVideo.snippet.title}</h4>
                            <p class="opacity-90 mb-2">${lastLiveVideo.snippet.description.substring(0, 150)}...</p>
                            <div class="flex items-center justify-between text-sm">
                                <span>Service Date: ${publishedAt.toLocaleDateString()}</span>
                                <span>Duration: ${duration}</span>
                            </div>
                        </div>
                    `;

                    // Store last video ID for watch button
                    window.lastVideoId = videoId;
                } else {
                    document.getElementById('last-service-details').innerHTML = `
                        <p class="opacity-90">No previous live services found.</p>
                    `;
                }
            } catch (error) {
                console.error('Error loading last service details:', error);
                document.getElementById('last-service-details').innerHTML = `
                    <p class="opacity-90">Unable to load service details at this time.</p>
                `;
            }
        }

        async function loadLiveVideoDetails(liveVideo) {
            try {
                const videoId = liveVideo.id.videoId;

                // Get detailed video information including live streaming details
                const response = await fetch(`https://www.googleapis.com/youtube/v3/videos?part=liveStreamingDetails,statistics,snippet&id=${videoId}&key=${API_KEY}`);
                const data = await response.json();

                if (data.items && data.items.length > 0) {
                    const videoDetails = data.items[0];
                    const liveDetails = videoDetails.liveStreamingDetails || {};
                    const stats = videoDetails.statistics || {};
                    const snippet = videoDetails.snippet || liveVideo.snippet;

                    // Update live video details with more comprehensive info
                    document.getElementById('live-title').textContent = snippet.title || liveVideo.snippet.title;
                    document.getElementById('live-description').textContent = (snippet.description || liveVideo.snippet.description || 'Join us for this live service from Dove Ministries Africa.').substring(0, 200) + '...';
                    document.getElementById('live-speaker').textContent = snippet.channelTitle || liveVideo.snippet.channelTitle;

                    // Format the start time
                    const startTime = liveDetails.actualStartTime || liveDetails.scheduledStartTime || liveVideo.snippet.publishedAt;
                    const startDate = new Date(startTime);
                    document.getElementById('live-date').textContent = startDate.toLocaleDateString() + ' at ' + startDate.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

                    // Update start time display
                    document.getElementById('live-start-time').textContent = startDate.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

                    // Show concurrent viewers if available
                    if (liveDetails.concurrentViewers) {
                        document.getElementById('live-viewers').innerHTML = `<i class="fas fa-eye mr-1"></i>${liveDetails.concurrentViewers} watching now`;
                        document.getElementById('live-viewers-count').textContent = liveDetails.concurrentViewers.toLocaleString();
                    } else if (liveDetails.actualStartTime) {
                        document.getElementById('live-viewers').innerHTML = '<i class="fas fa-circle mr-1 text-red-500"></i>Live now';
                        document.getElementById('live-viewers-count').textContent = 'Live broadcast active';
                    } else {
                        document.getElementById('live-viewers').innerHTML = '<i class="fas fa-clock mr-1"></i>Starting soon';
                        document.getElementById('live-viewers-count').textContent = 'Not yet started';
                    }

                    // Store video ID for YouTube button
                    window.liveVideoId = videoId;

                    console.log('Live video details loaded:', {
                        title: snippet.title,
                        viewers: liveDetails.concurrentViewers,
                        startTime: startTime,
                        description: snippet.description
                    });
                }
            } catch (error) {
                console.error('Error loading live video details:', error);
                // Fallback to basic info
                document.getElementById('live-title').textContent = liveVideo.snippet.title;
                document.getElementById('live-description').textContent = (liveVideo.snippet.description || '').substring(0, 200) + '...';
                document.getElementById('live-speaker').textContent = liveVideo.snippet.channelTitle;
                document.getElementById('live-date').textContent = new Date(liveVideo.snippet.publishedAt).toLocaleDateString();
                document.getElementById('live-viewers').innerHTML = '<i class="fas fa-circle mr-1 text-red-500"></i>Live';
                window.liveVideoId = liveVideo.id.videoId;
            }
        }

        function openLiveInYouTube() {
            if (window.liveVideoId) {
                window.open(`https://www.youtube.com/watch?v=${window.liveVideoId}`, '_blank');
            }
        }

        function watchLastService() {
            if (window.lastVideoId) {
                window.open(`https://www.youtube.com/watch?v=${window.lastVideoId}`, '_blank');
            }
        }

        // Global variables for sermon management
        let allSermons = [];
        let currentPage = 1;
        const sermonsPerPage = 6;
        let nextPageToken = null;
        let isLoading = false;

        // Load recent sermons from YouTube (most recent first)
        async function loadRecentSermons(loadMore = false) {
            if (isLoading) return;

            isLoading = true;
            const sermonsGrid = document.getElementById('sermons-grid');
            const loadingElement = document.getElementById('sermons-loading');
            const errorElement = document.getElementById('sermons-error');
            const loadMoreBtn = document.getElementById('load-more-btn');

            if (!loadMore) {
                loadingElement.classList.remove('hidden');
                errorElement.classList.add('hidden');
                sermonsGrid.innerHTML = '';
                currentPage = 1;
                nextPageToken = null;
            } else {
                // Show loading spinner on button
                const loadingText = loadMoreBtn.querySelector('.loading-text');
                const loadingSpinner = loadMoreBtn.querySelector('.loading-spinner');
                loadingText.classList.add('hidden');
                loadingSpinner.classList.remove('hidden');
                loadMoreBtn.disabled = true;
            }

            try {
                let url = `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${CHANNEL_ID}&order=date&type=video&maxResults=${sermonsPerPage}&key=${API_KEY}`;
                if (loadMore && nextPageToken) {
                    url += `&pageToken=${nextPageToken}`;
                }

                const response = await fetch(url);
                const data = await response.json();

                if (data.error) {
                    throw new Error('YouTube API Error: ' + data.error.message);
                }

                if (data.items && data.items.length > 0) {
                    // Get video details for all videos (including live streaming details)
                    const videoIds = data.items.map(item => item.id.videoId).join(',');
                    const detailsResponse = await fetch(`https://www.googleapis.com/youtube/v3/videos?part=contentDetails,statistics,liveStreamingDetails&id=${videoIds}&key=${API_KEY}`);
                    const detailsData = await detailsResponse.json();

                    const videoDetailsMap = {};
                    if (detailsData.items) {
                        detailsData.items.forEach(video => {
                            videoDetailsMap[video.id] = video;
                        });
                    }

                    // Create sermon cards - filter out live videos from recent sermons grid
                    data.items.forEach((item, index) => {
                        // Skip live videos in the recent sermons grid (they show in live section)
                        if (item.snippet.liveBroadcastContent === 'live') {
                            return;
                        }

                        const videoId = item.id.videoId;
                        const details = videoDetailsMap[videoId];
                        const duration = details ? parseDuration(details.contentDetails.duration) : 'N/A';
                        const viewCount = details ? formatViewCount(details.statistics.viewCount) : '0';

                        const sermonCard = createSermonCard(item, duration, viewCount);
                        sermonsGrid.appendChild(sermonCard);
                    });

                    // Store next page token
                    nextPageToken = data.nextPageToken;

                    // Hide loading and show content
                    loadingElement.classList.add('hidden');
                    errorElement.classList.add('hidden');

                    // Update load more button
                    if (loadMore) {
                        const loadingText = loadMoreBtn.querySelector('.loading-text');
                        const loadingSpinner = loadMoreBtn.querySelector('.loading-spinner');
                        loadingText.classList.remove('hidden');
                        loadingSpinner.classList.add('hidden');
                        loadMoreBtn.disabled = false;
                    }

                    // Hide load more if no more results or if we filtered out too many live videos
                    if (!nextPageToken || sermonsGrid.children.length === 0) {
                        document.getElementById('load-more-container').classList.add('hidden');
                    } else {
                        document.getElementById('load-more-container').classList.remove('hidden');
                    }

                    currentPage++;
                } else {
                    // No videos found
                    loadingElement.classList.add('hidden');
                    errorElement.classList.remove('hidden');
                    document.getElementById('load-more-container').classList.add('hidden');
                }
            } catch (error) {
                console.error('Error loading sermons:', error);
                loadingElement.classList.add('hidden');
                errorElement.classList.remove('hidden');
                document.getElementById('load-more-container').classList.add('hidden');

                if (loadMore) {
                    const loadingText = loadMoreBtn.querySelector('.loading-text');
                    const loadingSpinner = loadMoreBtn.querySelector('.loading-spinner');
                    loadingText.classList.remove('hidden');
                    loadingSpinner.classList.add('hidden');
                    loadMoreBtn.disabled = false;
                }
            } finally {
                isLoading = false;
            }
        }

        // Create sermon card element (gallery style)
        function createSermonCard(video, duration, viewCount) {
            const card = document.createElement('div');
            card.className = 'sermon-card bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-2 hover:scale-105';

            const publishedAt = new Date(video.snippet.publishedAt);
            const timeAgo = getTimeAgo(publishedAt);
            const thumbnailUrl = video.snippet.thumbnails.high?.url || video.snippet.thumbnails.medium?.url || video.snippet.thumbnails.default?.url;

            card.innerHTML = `
                <div class="relative group cursor-pointer" onclick="playVideoInModal('${video.id.videoId}', '${video.snippet.title.replace(/'/g, "\\'")}', '${(video.snippet.description || '').substring(0, 150).replace(/'/g, "\\'")}', '${publishedAt.toLocaleDateString()}', '${viewCount}')">
                    <div class="aspect-video bg-gray-200 relative overflow-hidden">
                        <img src="${thumbnailUrl}" alt="${video.snippet.title}" class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110">
                        <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-40 transition-all duration-300 flex items-center justify-center">
                            <div class="bg-white bg-opacity-90 rounded-full p-4 transform scale-75 group-hover:scale-100 transition-transform duration-300">
                                <i class="fas fa-play text-2xl text-blue-600"></i>
                            </div>
                        </div>
                        <div class="absolute top-3 left-3 bg-blue-600 text-white px-2 py-1 rounded text-xs font-medium">
                            <i class="fas fa-video mr-1"></i>Sermon
                        </div>
                        <div class="absolute bottom-3 right-3 bg-black bg-opacity-75 text-white px-2 py-1 rounded text-xs">
                            ${duration}
                        </div>
                    </div>
                </div>
                <div class="p-4">
                    <div class="flex items-start justify-between mb-2">
                        <span class="bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded-full font-medium">
                            <i class="fas fa-clock mr-1"></i>${timeAgo}
                        </span>
                        <span class="bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded-full">
                            <i class="fas fa-eye mr-1"></i>${viewCount}
                        </span>
                    </div>
                    <h3 class="text-lg font-semibold text-gray-900 mb-2 line-clamp-2 leading-tight hover:text-blue-600 transition-colors cursor-pointer" onclick="playVideoInModal('${video.id.videoId}', '${video.snippet.title.replace(/'/g, "\\'")}', '${(video.snippet.description || '').substring(0, 150).replace(/'/g, "\\'")}', '${publishedAt.toLocaleDateString()}', '${viewCount}')">${video.snippet.title}</h3>
                    <p class="text-gray-600 text-sm mb-4 line-clamp-3">${(video.snippet.description || 'No description available').substring(0, 120)}...</p>

                    <div class="flex items-center justify-between text-xs text-gray-500 mb-3">
                        <span><i class="fas fa-calendar mr-1"></i>${publishedAt.toLocaleDateString()}</span>
                        <span><i class="fas fa-clock mr-1"></i>${duration}</span>
                    </div>

                    <div class="flex space-x-2">
                        <button onclick="playVideoInModal('${video.id.videoId}', '${video.snippet.title.replace(/'/g, "\\'")}', '${(video.snippet.description || '').substring(0, 150).replace(/'/g, "\\'")}', '${publishedAt.toLocaleDateString()}', '${viewCount}')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-all duration-300 transform hover:scale-105 text-sm font-medium flex-1">
                            <i class="fas fa-play mr-1"></i> Watch Here
                        </button>
                        <button onclick="window.open('https://www.youtube.com/watch?v=${video.id.videoId}', '_blank')" class="bg-red-600 text-white px-3 py-2 rounded-lg hover:bg-red-700 transition-colors">
                            <i class="fab fa-youtube"></i>
                        </button>
                        <button onclick="shareSermon('${video.id.videoId}', '${video.snippet.title.replace(/'/g, "\\'")}')" class="bg-gray-100 text-gray-600 px-3 py-2 rounded-lg hover:bg-gray-200 transition-colors">
                            <i class="fas fa-share"></i>
                        </button>
                    </div>
                </div>
            `;

            return card;
        }

        // Helper functions
        function formatViewCount(count) {
            const num = parseInt(count);
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        function getTimeAgo(date) {
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

            if (diffDays === 1) return '1 day ago';
            if (diffDays < 7) return `${diffDays} days ago`;
            if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;
            if (diffDays < 365) return `${Math.floor(diffDays / 30)} months ago`;
            return `${Math.floor(diffDays / 365)} years ago`;
        }

        function openSermon(videoId) {
            window.open(`https://www.youtube.com/watch?v=${videoId}`, '_blank');
        }

        // Play video in modal
        function playVideoInModal(videoId, title, description, date, views) {
            const modal = document.getElementById('video-modal');
            const iframe = document.getElementById('modal-iframe');
            const modalTitle = document.getElementById('modal-title');
            const modalDescription = document.getElementById('modal-description');
            const modalDate = document.getElementById('modal-date');
            const modalViews = document.getElementById('modal-views');
            const modalDuration = document.getElementById('modal-duration');

            // Set modal content
            modalTitle.textContent = title;
            modalDescription.textContent = description || 'No description available for this video.';
            modalDate.textContent = date;
            modalViews.textContent = views + ' views';

            // Get video duration from the stored data
            const duration = getVideoDuration(videoId);
            modalDuration.textContent = duration || 'N/A';

            // Set iframe source
            iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0&modestbranding=1`;

            // Show modal
            modal.classList.remove('hidden');
            modal.classList.add('flex');

            // Prevent body scroll
            document.body.style.overflow = 'hidden';
        }

        // Helper function to get video duration (would need to be enhanced with API call)
        function getVideoDuration(videoId) {
            // This would ideally fetch from API, but for now return a placeholder
            // In a real implementation, you'd store this when loading videos
            return 'Video duration';
        }

        // Close video modal
        function closeVideoModal() {
            const modal = document.getElementById('video-modal');
            const iframe = document.getElementById('modal-iframe');

            // Stop video
            iframe.src = '';

            // Hide modal
            modal.classList.add('hidden');
            modal.classList.remove('flex');

            // Restore body scroll
            document.body.style.overflow = 'auto';
        }

        // Close modal when clicking outside
        document.addEventListener('click', function(event) {
            const modal = document.getElementById('video-modal');
            if (event.target === modal) {
                closeVideoModal();
            }
        });

        // Close modal on escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeVideoModal();
            }
        });

        // Load popular sermons (most viewed)
        async function loadPopularSermons() {
            const sermonsGrid = document.getElementById('sermons-grid');
            const loadingElement = document.getElementById('sermons-loading');
            const errorElement = document.getElementById('sermons-error');

            loadingElement.classList.remove('hidden');
            errorElement.classList.add('hidden');
            sermonsGrid.innerHTML = '';

            try {
                const response = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${CHANNEL_ID}&order=viewCount&type=video&maxResults=12&key=${API_KEY}`);
                const data = await response.json();

                if (data.items && data.items.length > 0) {
                    const videoIds = data.items.map(item => item.id.videoId).join(',');
                    const detailsResponse = await fetch(`https://www.googleapis.com/youtube/v3/videos?part=contentDetails,statistics&id=${videoIds}&key=${API_KEY}`);
                    const detailsData = await detailsResponse.json();

                    const videoDetailsMap = {};
                    if (detailsData.items) {
                        detailsData.items.forEach(video => {
                            videoDetailsMap[video.id] = video;
                        });
                    }

                    data.items.forEach((item) => {
                        const videoId = item.id.videoId;
                        const details = videoDetailsMap[videoId];
                        const duration = details ? parseDuration(details.contentDetails.duration) : 'N/A';
                        const viewCount = details ? formatViewCount(details.statistics.viewCount) : '0';

                        const sermonCard = createSermonCard(item, duration, viewCount);
                        sermonsGrid.appendChild(sermonCard);
                    });

                    loadingElement.classList.add('hidden');
                    document.getElementById('load-more-container').classList.add('hidden'); // No pagination for popular
                } else {
                    loadingElement.classList.add('hidden');
                    errorElement.classList.remove('hidden');
                }
            } catch (error) {
                console.error('Error loading popular sermons:', error);
                loadingElement.classList.add('hidden');
                errorElement.classList.remove('hidden');
            }
        }

        // Load sermon series (attempt to group by similar titles or use playlists)
        async function loadSermonSeries() {
            const sermonsGrid = document.getElementById('sermons-grid');
            const loadingElement = document.getElementById('sermons-loading');
            const errorElement = document.getElementById('sermons-error');

            loadingElement.classList.remove('hidden');
            errorElement.classList.add('hidden');
            sermonsGrid.innerHTML = '';

            try {
                // Try to get playlists first
                const playlistResponse = await fetch(`https://www.googleapis.com/youtube/v3/playlists?part=snippet&channelId=${CHANNEL_ID}&maxResults=10&key=${API_KEY}`);
                const playlistData = await playlistResponse.json();

                if (playlistData.items && playlistData.items.length > 0) {
                    // Display playlists as series
                    playlistData.items.forEach((playlist) => {
                        const seriesCard = createSeriesCard(playlist);
                        sermonsGrid.appendChild(seriesCard);
                    });
                } else {
                    // Fallback: group recent videos by keywords in titles
                    const response = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${CHANNEL_ID}&order=date&type=video&maxResults=20&key=${API_KEY}`);
                    const data = await response.json();

                    if (data.items && data.items.length > 0) {
                        const series = groupVideosBySeries(data.items);
                        Object.values(series).forEach((seriesVideos) => {
                            if (seriesVideos.length > 1) {
                                const seriesCard = createGroupedSeriesCard(seriesVideos);
                                sermonsGrid.appendChild(seriesCard);
                            }
                        });
                    }
                }

                loadingElement.classList.add('hidden');
                document.getElementById('load-more-container').classList.add('hidden');
            } catch (error) {
                console.error('Error loading sermon series:', error);
                loadingElement.classList.add('hidden');
                errorElement.classList.remove('hidden');
            }
        }

        // Helper function to group videos by series based on title patterns
        function groupVideosBySeries(videos) {
            const series = {};

            videos.forEach(video => {
                const title = video.snippet.title.toLowerCase();
                let seriesName = 'General Teachings';

                // Look for common series patterns
                if (title.includes('fruit of the spirit')) {
                    seriesName = 'Fruit of the Spirit';
                } else if (title.includes('prayer') || title.includes('intercession')) {
                    seriesName = 'Prayer & Intercession';
                } else if (title.includes('faith') || title.includes('believe')) {
                    seriesName = 'Faith & Belief';
                } else if (title.includes('love') || title.includes('charity')) {
                    seriesName = 'Love & Relationships';
                }

                if (!series[seriesName]) {
                    series[seriesName] = [];
                }
                series[seriesName].push(video);
            });

            return series;
        }

        // Create series card for playlists
        function createSeriesCard(playlist) {
            const card = document.createElement('div');
            card.className = 'sermon-card bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1';

            card.innerHTML = `
                <div class="relative group cursor-pointer" onclick="openPlaylist('${playlist.id}')">
                    <div class="aspect-video bg-gradient-to-br from-purple-400 to-purple-600 flex items-center justify-center">
                        <i class="fas fa-list text-5xl text-white"></i>
                    </div>
                    <div class="absolute top-4 right-4 bg-purple-600 text-white px-3 py-1 rounded-full text-sm font-medium">
                        Series
                    </div>
                </div>
                <div class="p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-2 line-clamp-2">${playlist.snippet.title}</h3>
                    <p class="text-gray-600 text-sm mb-4 line-clamp-3">${playlist.snippet.description || 'A collection of related teachings and sermons.'}</p>
                    <div class="flex items-center justify-between">
                        <div class="flex space-x-2">
                            <button onclick="openPlaylist('${playlist.id}')" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors text-sm font-medium">
                                <i class="fas fa-play mr-1"></i> View Series
                            </button>
                        </div>
                    </div>
                </div>
            `;

            return card;
        }

        // Create grouped series card
        function createGroupedSeriesCard(videos) {
            const seriesName = videos[0].snippet.title.toLowerCase().includes('fruit') ? 'Fruit of the Spirit' :
                              videos[0].snippet.title.toLowerCase().includes('prayer') ? 'Prayer & Intercession' :
                              videos[0].snippet.title.toLowerCase().includes('faith') ? 'Faith & Belief' :
                              videos[0].snippet.title.toLowerCase().includes('love') ? 'Love & Relationships' :
                              'General Teachings';

            const card = document.createElement('div');
            card.className = 'sermon-card bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1';

            card.innerHTML = `
                <div class="relative group cursor-pointer" onclick="openSeriesVideos('${videos.map(v => v.id.videoId).join(',')}')">
                    <div class="aspect-video bg-gradient-to-br from-purple-400 to-purple-600 flex items-center justify-center">
                        <i class="fas fa-list text-5xl text-white"></i>
                    </div>
                    <div class="absolute top-4 right-4 bg-purple-600 text-white px-3 py-1 rounded-full text-sm font-medium">
                        ${videos.length} Parts
                    </div>
                </div>
                <div class="p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-2">${seriesName}</h3>
                    <p class="text-gray-600 text-sm mb-4">${videos.length} teachings in this series</p>
                    <div class="space-y-2 mb-4">
                        ${videos.slice(0, 3).map(video => `<div class="text-xs text-gray-500 truncate">â¢ ${video.snippet.title}</div>`).join('')}
                        ${videos.length > 3 ? `<div class="text-xs text-gray-500">â¢ and ${videos.length - 3} more...</div>` : ''}
                    </div>
                    <div class="flex items-center justify-between">
                        <div class="flex space-x-2">
                            <button onclick="openSeriesVideos('${videos.map(v => v.id.videoId).join(',')}')" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors text-sm font-medium">
                                <i class="fas fa-play mr-1"></i> Watch Series
                            </button>
                        </div>
                    </div>
                </div>
            `;

            return card;
        }

        function openPlaylist(playlistId) {
            window.open(`https://www.youtube.com/playlist?list=${playlistId}`, '_blank');
        }

        function openSeriesVideos(videoIds) {
            const firstVideoId = videoIds.split(',')[0];
            window.open(`https://www.youtube.com/watch?v=${firstVideoId}`, '_blank');
        }

        function shareSermon(videoId, title) {
            const url = `https://www.youtube.com/watch?v=${videoId}`;
            if (navigator.share) {
                navigator.share({
                    title: title,
                    url: url
                });
            } else {
                // Fallback: copy to clipboard
                navigator.clipboard.writeText(url).then(() => {
                    alert('Link copied to clipboard!');
                });
            }
        }

        // Sermon filtering functionality (updated for dynamic content)
        document.addEventListener('DOMContentLoaded', function() {
            const filterButtons = document.querySelectorAll('.filter-btn');
            const loadMoreBtn = document.getElementById('load-more-btn');

            filterButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const filter = this.getAttribute('data-filter');

                    // Update active button
                    filterButtons.forEach(btn => {
                        btn.classList.remove('active', 'bg-blue-600', 'text-white');
                        btn.classList.add('bg-gray-200', 'text-gray-700');
                    });
                    this.classList.add('active', 'bg-blue-600', 'text-white');
                    this.classList.remove('bg-gray-200', 'text-gray-700');

                    // Handle different filter types
                    switch(filter) {
                        case 'all':
                        case 'recent':
                            loadRecentSermons(false);
                            break;
                        case 'popular':
                            loadPopularSermons();
                            break;
                        case 'series':
                            loadSermonSeries();
                            break;
                        default:
                            loadRecentSermons(false);
                    }
                });
            });

            // Load more button
            if (loadMoreBtn) {
                loadMoreBtn.addEventListener('click', () => loadRecentSermons(true));
            }

            // Initialize live service check, featured sermon, and recent sermons
            checkLiveService();
            loadFeaturedSermon();
            loadRecentSermons();
        });

        // Sermon subscription form
        document.getElementById('sermon-subscribe-form').addEventListener('submit', function(e) {
            e.preventDefault();

            const email = this.querySelector('input[type="email"]').value;

            // Here you would typically send the email to your server
            console.log('Sermon subscription:', email);

            // Show success message
            alert('Thank you for subscribing! You will receive notifications for new sermons.');

            // Reset form
            this.reset();
        });
    </script>
</body>
</html>



